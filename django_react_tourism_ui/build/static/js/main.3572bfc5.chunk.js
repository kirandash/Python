(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{39:function(e,t,a){e.exports=a(76)},44:function(e,t,a){},45:function(e,t,a){},46:function(e,t,a){},47:function(e,t,a){},48:function(e,t,a){},72:function(e,t,a){},73:function(e,t,a){},74:function(e,t,a){},75:function(e,t,a){},76:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),i=a(34),c=a.n(i),s=(a(44),a(35)),l=a(4),o=a(5),u=a(7),m=a(6),d=a(17),h=a(8),p=a(14),f=a(16),v=(a(45),r.a.createContext({booking:null,wishlist:[],toggleWishlist:function(){},addToCart:function(){},removeFromCart:function(){}})),b=(a(46),a(11));a(47),a(48);function E(e){var t=e.itemId;return r.a.createElement(v.Consumer,null,function(e){return r.a.createElement("button",{className:"AddToWishlist",onClick:function(){return e.toggleWishlist(t)}},e.wishlist.includes(t)?r.a.createElement(b.a,null):r.a.createElement(b.d,null))})}function g(e){var t=e.wishlist,a=e.toggleWishlist,n=e.item,i=e.route;return r.a.createElement("div",{className:"Item","data-testid":"item"},r.a.createElement("h3",null,r.a.createElement(E,{wishlist:t,itemId:n.id,toggle:a}),r.a.createElement(p.b,{to:i},n.name)),r.a.createElement("img",{src:n.thumbnail_url,alt:n.name}),r.a.createElement("p",{className:"Item-price"},"$",n.price," USD total"),r.a.createElement("p",null,"Difficulty Rating: ",n.rating,"\xa0",r.a.createElement("span",{className:"Item-rating Item-rating__".concat(n.rating)},r.a.createElement(b.c,null),r.a.createElement(b.c,null),r.a.createElement(b.c,null))),r.a.createElement("p",null,n.promo),r.a.createElement(p.b,{className:"Item-more",to:i},"Learn more!"))}var O,y=a(2),k=a.n(y),w=a(13),j=a(18),x=a.n(j),C="UYpBkKY6vYW72ayc7ovAZ5xvUapQ3a8TucsGI2jS",N="REvBZR4e1yVflIrF1FAWcLVl08ZtewuxinaQsSNt6XKpxar6v17LvjkrCkKVDqHQUTDCcLfuZfm1V7JQ0C9qdKnYQpbjjjMrYMt76kdzTtE3xGv4ZaxdX9TnLsTeadZu";function _(){return A.apply(this,arguments)}function A(){return(A=Object(w.a)(k.a.mark(function e(){var t,a;return k.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new Promise(function(e){if(O)e(O);else{var t={grant_type:"client_credentials",client_id:C,client_secret:N,scope:"read"};x.a.post("/oauth/token/",t).then(function(t){O=t.data.access_token,e(O)})}});case 2:return t=e.sent,a={headers:{Authorization:"Bearer ".concat(t)}},e.abrupt("return",new Promise(function(e){e(a)}));case 5:case"end":return e.stop()}},e)}))).apply(this,arguments)}var P={retrieveWishlist:function(){var e=Object(w.a)(k.a.mark(function e(){var t;return k.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,_();case 2:return t=e.sent,e.abrupt("return",new Promise(function(e){x.a.get("/api/v1/wishlist/",t).then(function(t){e(t.data)})}));case 4:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}(),wishlistAdd:function(){var e=Object(w.a)(k.a.mark(function e(t){var a,n;return k.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,_();case 2:return a=e.sent,n={id:t},e.abrupt("return",x.a.post("/api/v1/wishlist/",n,a));case 5:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),wishlistDelete:function(){var e=Object(w.a)(k.a.mark(function e(t){var a;return k.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,_();case 2:return a=e.sent,e.abrupt("return",x.a.delete("/api/v1/wishlist/".concat(t,"/"),a));case 4:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),wishlistCartStatus:function(){var e=Object(w.a)(k.a.mark(function e(t,a){var n,r;return k.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,_();case 2:return n=e.sent,r={id:t,added_to_cart:a},e.abrupt("return",x.a.patch("/api/v1/wishlist/".concat(t,"/"),r,n));case 5:case"end":return e.stop()}},e)}));return function(t,a){return e.apply(this,arguments)}}(),retrieveDetails:function(){var e=Object(w.a)(k.a.mark(function e(t){var a;return k.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,_();case 2:return a=e.sent,e.abrupt("return",new Promise(function(e){x.a.get("/api/v1/public/packages/".concat(t,"/"),a).then(function(t){e(t.data)})}));case 4:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),retrieveList:function(){var e=Object(w.a)(k.a.mark(function e(){var t;return k.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,_();case 2:return t=e.sent,e.abrupt("return",new Promise(function(e){x.a.get("/api/v1/public/packages/",t).then(function(t){e(t.data)})}));case 4:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}()};(function(e){function t(){return Object(l.a)(this,t),Object(u.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){var e=this.context,t=e.wishlist,a=e.toggleWishlist;return r.a.createElement("section",{className:"List","data-testid":"list"},r.a.createElement("section",{className:"List-items"},r.a.createElement(g,{route:"/details/1",item:{id:1,name:"Example",thumbnail_url:"/images/map_channel.gif",price:777.77,rating:"easy",promo:"Tour package description"},wishlist:t,toggleWishlist:a})))}}]),t}(r.a.Component)).context=v;var S=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(u.a)(this,Object(m.a)(t).call(this,e))).state={list:[],totalItems:0},a.updateList(),a}return Object(h.a)(t,e),Object(o.a)(t,[{key:"updateList",value:function(){var e=this;P.retrieveList().then(function(t){var a=t,n=t.length;e.setState({list:a,totalItems:n})})}},{key:"render",value:function(){var e=this.context,t=e.wishlist,a=e.toggleWishlist,n=this.state.list;return r.a.createElement("section",{className:"List","data-testid":"list"},r.a.createElement("section",{className:"List-items"},n.map(function(e){return r.a.createElement(g,{key:e.id,route:"/details/".concat(e.id),item:e,wishlist:t,toggleWishlist:a})})))}}]),t}(r.a.Component);S.contextType=v;a(72);var I=function(e){function t(e){var a;Object(l.a)(this,t),(a=Object(u.a)(this,Object(m.a)(t).call(this,e))).state={details:null,alreadyAddedToCart:!1};var n=e.match.params.id;return P.retrieveDetails(n).then(function(e){var t=a.context.item;a.setState({details:e,alreadyAddedToCart:t&&t.id===n})}),a}return Object(h.a)(t,e),Object(o.a)(t,[{key:"addToCart",value:function(){var e=Object(w.a)(k.a.mark(function e(){return k.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.context.setOrderItem(this.state.details);case 2:this.props.history.push("/checkout");case 3:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this.state,t=e.details,a=e.alreadyAddedToCart;return null===t?r.a.createElement("section",{className:"Details"}):r.a.createElement("section",{className:"Details","data-testid":"details"},r.a.createElement("section",{className:"Details-content"},r.a.createElement("header",null,r.a.createElement("h2",null,r.a.createElement(E,{itemId:t.id}),t.name)),r.a.createElement("section",null,r.a.createElement("img",{src:t.thumbnail_url,alt:t.name}),r.a.createElement("p",null,"Starts on: ",t.start),r.a.createElement("p",null,"Tour Length: ",t.tour_length," days"),r.a.createElement("p",null,r.a.createElement("span",{className:"Details-label"},"Total Price:"),"\xa0$",t.price)),r.a.createElement("section",null,t.promo)),r.a.createElement("section",{className:"Details-reserve"},r.a.createElement("button",{className:"Details-buy","data-testid":"buy",onClick:this.addToCart.bind(this)},a?"Already Reserved":"Reserve")))}}]),t}(r.a.Component);I.contextType=v;a(73),a(19),a(74),r.a.Component,a(75);var T=a(38);var W,D=(W=function(e){var t=e.name,a=e.label,n=e.value,i=e.onUpdate;return r.a.createElement("div",{key:t,className:"FormField"},r.a.createElement("label",null,a),r.a.createElement("br",null),r.a.createElement("input",{type:"text",name:t,value:n,onChange:function(e){i(t,e.target.value)}}))},function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(u.a)(this,Object(m.a)(t).call(this,e))).state={error:null},a}return Object(h.a)(t,e),Object(o.a)(t,[{key:"validate",value:function(e,t){0===t.length?this.setState({error:"Field cannot be empty"}):this.setState({error:null}),this.props.onUpdate(e,t)}},{key:"render",value:function(){var e=this.state.error,t=this.props,a=(t.onUpdate,Object(T.a)(t,["onUpdate"]));return r.a.createElement("div",{className:"Validated"},r.a.createElement(W,Object.assign({onUpdate:this.validate.bind(this)},a)),e&&r.a.createElement("div",{className:"Error"},e))}}]),t}(r.a.Component)),L=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(u.a)(this,Object(m.a)(t).call(this,e))).state={validationErrors:[],orderPlaced:!1},a}return Object(h.a)(t,e),Object(o.a)(t,[{key:"placeOrder",value:function(){var e=this;this.context.placeOrder().then(function(){e.setState({validationErrors:[],orderPlaced:!0})}).catch(function(t){e.setState({validationErrors:t,orderPlaced:!1})})}},{key:"render",value:function(){var e=this.context,t=e.booking,a=e.item,n=e.updateField,i=e.clearOrderItem,c=this.state,s=c.validationErrors,l=c.orderPlaced,o=[{label:"Name",name:"name"},{label:"Email Address",name:"email_address"},{label:"Street Address",name:"street_address"},{label:"City",name:"city"}],u=[];o.forEach(function(e){var t=s[e.name];t&&u.push(r.a.createElement("li",{className:"error",key:e.name},e.label,": ",t))});var m,d=o.map(function(e){return r.a.createElement(D,Object.assign({key:e.name,value:t[e.name],onUpdate:n},e))});return l?r.a.createElement("section",{className:"Checkout"},r.a.createElement("header",{className:"Checkout-header"},r.a.createElement("h2",null,"Checkout"),r.a.createElement("h3",null,"Thanks for buying an excursion with Explore California!"))):(a&&(m=r.a.createElement("div",null,r.a.createElement("button",{className:"Checkout-package-remove",onClick:function(){return i(a.id)}},r.a.createElement(b.b,null)),a.name," - $",a.price," starts on ",a.start," for ",a.tour_length," days.")),r.a.createElement("section",{className:"Checkout"},r.a.createElement("header",{className:"Checkout-header"},r.a.createElement("h2",null,"Checkout")),r.a.createElement("section",{className:"Checkout-summary"},m),r.a.createElement("section",{className:"Checkout-form"},r.a.createElement("form",null,r.a.createElement("ul",null,u),d)),r.a.createElement("section",{className:"Checkout-actions"},r.a.createElement("div",{className:"Checkout-actions__next"},r.a.createElement("button",{disabled:l||null===a,onClick:this.placeOrder.bind(this)},"Place order")))))}}]),t}(r.a.Component);function F(e){var t=e.item;return r.a.createElement(p.b,{className:"Cart",to:"/checkout"},r.a.createElement(b.e,null),t&&t.name)}function U(e){return r.a.createElement("section",{className:"App-sidebar"},r.a.createElement("header",{className:"App-sidebar__header"},r.a.createElement("h2",null,"Our Tours")),r.a.createElement("section",{className:"App-sidebar__intro"},r.a.createElement("h3",null,"Explore California"),r.a.createElement("p",null,"What type of California experience do you want to have? Are you looking for an exciting adventure? A chance to relax and get away from it all? Or maybe you're looking for a chance to do something entirely new and enriching! As you can see, we've got you covered. We offer tours that are as diverse as California itself! Select any of our tours learn more about pricing and available options.")))}function B(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),a.push.apply(a,n)}return a}L.contextType=v;var Z=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(u.a)(this,Object(m.a)(t).call(this,e))).state={wishlist:[],booking:{name:"",email_address:"",street_address:"",city:""},item:null,toggleWishlist:a.toggleWishlist.bind(Object(d.a)(a)),updateField:a.updateField.bind(Object(d.a)(a)),setOrderItem:a.setOrderItem.bind(Object(d.a)(a)),clearOrderItem:a.clearOrderItem.bind(Object(d.a)(a)),placeOrder:a.placeOrder.bind(Object(d.a)(a))},P.retrieveWishlist().then(function(e){a.setState({wishlist:e})}),a}return Object(h.a)(t,e),Object(o.a)(t,[{key:"toggleWishlist",value:function(e){var t=this;(this.state.wishlist.includes(e)?P.wishlistDelete(e):P.wishlistAdd(e)).then(function(){P.retrieveWishlist().then(function(e){t.setState({wishlist:e})})})}},{key:"updateField",value:function(e,t){var a=this.state.booking;a[e]=t,this.setState({booking:a})}},{key:"setOrderItem",value:function(e){var t=this;return new Promise(function(a){P.wishlistCartStatus(e.id,!0).then(function(){t.setState({item:e}),a(e)})})}},{key:"clearOrderItem",value:function(e){var t=this;return new Promise(function(a){P.wishlistCartStatus(e,!1).then(function(){t.setState({item:null}),a()})})}},{key:"placeOrder",value:function(){var e=this,t=this.state,a=t.booking,n=t.item,r=function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?B(a,!0).forEach(function(t){Object(s.a)(e,t,a[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):B(a).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))})}return e}({},a);return r.package=n.id,new Promise(function(t,a){P.createBooking(r).then(function(){e.setState({item:null}),t()}).catch(function(e){a(e)})})}},{key:"render",value:function(){return r.a.createElement(p.a,null,r.a.createElement("div",{className:"App"},r.a.createElement("nav",{className:"App-nav"},r.a.createElement("div",{className:"App-nav__main"},r.a.createElement(p.c,{to:"/"},"Explore our tours")),r.a.createElement("div",{className:"App-nav__links"},r.a.createElement("button",null,"Advertise your tour"),r.a.createElement("button",null,"Help"),r.a.createElement(F,{booking:this.state.booking}))),r.a.createElement(U,null),r.a.createElement("section",{className:"App-content"},r.a.createElement(v.Provider,{value:this.state},r.a.createElement(f.a,{path:"/",exact:!0,component:S}),r.a.createElement(f.a,{path:"/details/:id",component:I}),r.a.createElement(f.a,{path:"/checkout",component:L})))))}}]),t}(r.a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(r.a.createElement(Z,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[39,1,2]]]);
//# sourceMappingURL=main.3572bfc5.chunk.js.map